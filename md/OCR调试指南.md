# OCR调试指南

## 当前状态

✅ 前端已修复：现在可以正确处理空文本结果  
✅ 后端已添加详细日志：可以查看OCR原始返回格式  

## 重启服务

1. **停止OCR服务**: 按 `Ctrl+C`
2. **重新启动**:
   ```bash
   python ocr_service.py
   ```

## 测试步骤

1. **刷新前端页面**: http://localhost:8000
2. **上传测试图片**: 
   - 点击📎按钮
   - 选择一张包含清晰文字的图片
3. **查看后端日志**:
   ```
   INFO:__main__:接收到图片: xxx.jpg
   INFO:__main__:开始OCR识别...
   INFO:__main__:OCR原始结果类型: <class 'list'>
   INFO:__main__:OCR原始结果长度: X
   INFO:__main__:result[0]类型: <class 'list'>
   INFO:__main__:result[0]内容: [...]
   INFO:__main__:识别文本: XXX (置信度: 0.XX)
   INFO:__main__:OCR识别完成，共识别 X 行文本
   ```

## 预期行为

### 场景1: 识别到文字
- 后端日志显示识别的文本
- 前端显示: "识别成功，共X行文字"
- 文字自动填入输入框

### 场景2: 未识别到文字
- 后端日志显示: "OCR识别完成，共识别 0 行文本"
- 前端显示: "未识别到文字内容"
- 输入框保持原样

### 场景3: 识别失败
- 后端日志显示错误信息
- 前端显示: "OCR识别失败: [错误信息]"

## 常见问题

### 1. 识别不到文字

**可能原因**:
- 图片模糊或分辨率太低
- 文字太小
- 背景复杂
- 字体特殊

**解决方法**:
- 使用清晰的图片
- 确保文字足够大
- 尝试不同的图片

### 2. 识别结果为空但图片有文字

**排查步骤**:
1. 查看后端日志中的 "OCR原始结果" 信息
2. 检查 `result[0]` 的内容
3. 如果原始结果有数据但解析失败，说明返回格式不匹配

### 3. 前端显示错误但后端成功

**已修复**: 前端现在可以正确处理空文本结果

## 调试技巧

### 查看完整的OCR结果

临时修改 `ocr_service.py` 第182行附近，添加:
```python
logger.info(f"完整OCR结果: {result}")
```

### 测试特定图片

使用curl直接测试:
```bash
curl -X POST -F "image=@test.jpg" http://localhost:8002/api/ocr/recognize
```

### 查看PaddleOCR版本

```python
import paddleocr
print(paddleocr.__version__)
```

## 下一步

重启服务后，上传一张清晰的包含文字的图片，查看后端日志输出，然后告诉我结果！
